(("undefined"!==typeof self?self:this)["webpackJsonpxthon"]=("undefined"!==typeof self?self:this)["webpackJsonpxthon"]||[]).push([[48,63,70],{"145d":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.fieldIsOpen&&t.isStandalone?i("div",{staticClass:"overlay"}):t._e(),i("div",{class:"field-wrapper layout-"+t.layout+" is-open-"+t.fieldIsOpen+" flex-one"},[i("UserDialog",{attrs:{spinner:t.userDialogSpinner,state:t.userDialogModal,"disable-close":t.userDialogSpinner},on:{"modal:close":function(e){t.cancelEdition()}}},[i("div",{attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.userDialogHeading))]),i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v(t._s(t.userDialogMessage))])])]),i("div",{staticClass:"editable-field-wrapper flex-one",class:{columns:!t.isStandalone}},[i("div",{class:{"flex-one":t.isBackgroundImage&&!t.fieldIsOpen,"column is-6":!t.isStandalone}},[t.fieldIsOpen?t._e():i("div",{class:{"flex-one":t.isBackgroundImage},on:{click:function(e){t.openEdition()}}},[i("LazyLoadedImage",{staticClass:"inline-image-item",class:{"is-open":t.fieldIsOpen,"is-background":t.isBackgroundImage},attrs:{"is-background":t.isBackgroundImage,src:t.staticImage,alt:t.alt,"default-text":t.defaultText,"is-editable":t.editionIsEnabled}})],1),t.fieldIsOpen?i("croppa",{style:{width:t.calculateWidth+6+"px",height:t.calculateHeight+6+"px"},attrs:{"initial-image":t.croppaInitialImage,placeholder:"Select file","placeholder-font-size":20,"show-remove-button":!1,width:t.calculateWidth,height:t.calculateHeight,"prevent-white-space":!0},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.saveImage()},"new-image":function(e){t.errorMessage=""}},model:{value:t.croppaObject,callback:function(e){t.croppaObject=e},expression:"croppaObject"}},[i("div",{attrs:{slot:"initial"},slot:"initial"},[t._v("Click here to upload a file")])]):t._e()],1),t.editionIsEnabled?i("div",{staticClass:"image-control",class:{"column is-6":!t.isStandalone,"hero-image":.3===t.ratio}},[i("div",{staticClass:"action-icons-wrapper",class:{"is-open":t.fieldIsOpen}},[i("div",{staticClass:"action-icon-wrapper",class:{"hide-icon":t.fieldIsOpen},on:{click:function(e){t.openEdition()}}},[i("Icons",{staticClass:"action-icon",attrs:{icon:"pencil",iconwidth:"16px",iconheight:"16px",color:"#FFF"}})],1),i("div",{staticClass:"action-icon-wrapper",class:{"hide-icon":!t.fieldIsOpen},on:{click:function(e){t.saveImage()}}},[i("Icons",{staticClass:"action-icon",attrs:{icon:"check",iconwidth:"16px",iconheight:"16px",color:"#FFF"}})],1),i("div",{staticClass:"action-icon-wrapper",class:{"hide-icon":!t.fieldIsOpen},on:{click:function(e){t.cancelEdition()}}},[i("Icons",{staticClass:"action-icon",attrs:{icon:"close-circle",iconwidth:"16px",iconheight:"16px",color:"#FFF"}})],1)]),i("div",{staticClass:"button-wrapper"},[!t.disableOrientation&&t.fieldIsOpen?i("div",{staticClass:"orientation-wrapper"},[i("div",{on:{click:function(e){t.ratio=1}}},[i("Icons",{staticClass:"action-icon",attrs:{icon:"crop-square",iconwidth:"24px",iconheight:"24px",color:"#333"}})],1),i("div",{on:{click:function(e){t.ratio=4/3}}},[i("Icons",{staticClass:"action-icon",attrs:{icon:"crop-portrait",iconwidth:"24px",iconheight:"24px",color:"#333"}})],1),i("div",{on:{click:function(e){t.ratio=.75}}},[i("Icons",{staticClass:"action-icon",attrs:{icon:"crop-landscape",iconwidth:"24px",iconheight:"24px",color:"#333"}})],1)]):t._e(),t.required?t._e():i("button",{staticClass:"button is-warning",on:{click:function(e){t.removeImage()}}},[t._v("Remove")]),t.fieldIsOpen?i("button",{staticClass:"button is-info",on:{click:function(e){t.clearField()}}},[t._v("Clear")]):t._e(),t.defaultImage&&t.fieldIsOpen?i("button",{staticClass:"button is-primary",on:{click:function(e){t.useDefault()}}},[t._v("Use default")]):t._e(),t.fieldIsOpen?i("button",{staticClass:"button is-success",on:{click:function(e){t.saveImage()}}},[t._v("Generate")]):t._e()]),t.fieldIsOpen?i("div",{staticClass:"instructions"},[i("p",[t._v("Move the picture around the frame to crop it. You can also scroll or pinch with two fingers to zoom.")]),i("p",[t._v("Click generate once ready to save the image.")])]):t._e()]):t._e()]),i("transition",{attrs:{name:"slide-fade"}},[t.errorMessage?i("div",{staticClass:"editable-error-message-wrapper"},[i("span",{staticClass:"editable-error-message"},[t._v(t._s(t.errorMessage))])]):t._e()])],1)])},o=[],s=i("4706"),r=i("623f"),a={props:["item","layout","location","openId","openDefault","isBackgroundImage","alt","editionIsEnabled","type","is-standalone","disableOrientation","initialRatio","defaultImage","required","defaultText"],data:function(){return{croppaObject:{},croppaInitialImage:"",ratio:1,userDialogSpinner:!0,userDialogModal:!1,userDialogHeading:"Processing...",userDialogMessage:"",fieldIsOpen:!1,fieldValue:this.value,errorMessage:"",blurTimeout:null}},components:{Icons:s["default"],LazyLoadedImage:r["default"],UserDialog:function(){return i.e(1).then(i.bind(null,"b7cf"))}},computed:{calculateWidth:function(){if("undefined"===typeof window||"undefined"===typeof this.$el)return 400;var t=this.$el.clientWidth;return"avatar"===this.type?"overlay"===this.layout?t-12:t/2-12:t<400?t-6:400},calculateHeight:function(){return this.calculateWidth*this.ratio},initialImage:function(){return"undefined"!==typeof this.item?this.item.src:""},staticImage:function(){return this.initialImage?this.initialImage:this.defaultImage?this.defaultImage.src:""}},mounted:function(){this.openDefault&&this.openEdition(),this.initialRatio&&(this.ratio=this.initialRatio),this.croppaInitialImage=this.initialImage},methods:{cancelEdition:function(){this.fieldIsOpen&&!this.croppaObject.hasImage()&&this.$emit("image:remove"),this.fieldIsOpen=!1,this.errorMessage="",this.userDialogModal=!1,this.$emit("edition:close",this._uid)},openEdition:function(){this.editionIsEnabled&&(this.fieldIsOpen=!0,this.$emit("edition:open",this._uid))},clearField:function(){this.croppaObject&&this.croppaObject.hasImage()&&this.croppaObject.remove()},useDefault:function(){this.croppaInitialImage=this.defaultImage.src,this.croppaObject.refresh()},removeImage:function(){var t=this;this.userDialogModal=!0,this.userDialogSpinner=!0,this.errorMessage="","undefined"!==typeof this.item?this.$store.dispatch("REMOVE_IMAGE",{location:this.location,route:this.$route,id:this.item.id}).then(function(){t.cancelEdition()}).catch(function(e){t.userDialogSpinner=!1,t.errorMessage="An unknown error occurred.",console.log(e)}):this.cancelEdition()},saveImage:function(){var t=this;this.fieldIsOpen&&(this.userDialogModal=!0,this.croppaObject.generateBlob(function(e){e?(t.userDialogSpinner=!0,t.$store.dispatch("SAVE_IMAGE_FIELD",{location:t.location,route:t.$route,blob:e}).then(function(){t.cancelEdition()}).catch(function(t){console.log(t)})):(t.userDialogMessage="The image couldn't be generated.",t.userDialogSpinner=!1)},"image/jpeg",.8))}},watch:{openId:function(t){this.fieldIsOpen&&t!==this._uid&&(this.fieldIsOpen=!1)}}},c=a,l=(i("353b"),i("2877")),h=Object(l["a"])(c,n,o,!1,null,"2a421070",null);h.options.__file="InlineImageEditor.vue";e["default"]=h.exports},"353b":function(t,e,i){"use strict";var n=i("addf"),o=i.n(n);o.a},"5abe":function(t,e){(function(t,e){"use strict";if("IntersectionObserver"in t&&"IntersectionObserverEntry"in t&&"intersectionRatio"in t.IntersectionObserverEntry.prototype)"isIntersecting"in t.IntersectionObserverEntry.prototype||Object.defineProperty(t.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var i=[];o.prototype.THROTTLE_TIMEOUT=100,o.prototype.POLL_INTERVAL=null,o.prototype.USE_MUTATION_OBSERVER=!0,o.prototype.observe=function(t){var e=this._observationTargets.some(function(e){return e.element==t});if(!e){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},o.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter(function(e){return e.element!=t}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},o.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},o.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},o.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter(function(t,e,i){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==i[e-1]})},o.prototype._parseRootMargin=function(t){var e=t||"0px",i=e.split(/\s+/).map(function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}});return i[1]=i[1]||i[0],i[2]=i[2]||i[0],i[3]=i[3]||i[1],i},o.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(a(t,"resize",this._checkForIntersections,!0),a(e,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in t&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},o.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,c(t,"resize",this._checkForIntersections,!0),c(e,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},o.prototype._checkForIntersections=function(){var t=this._rootIsInDom(),e=t?this._getRootRect():u();this._observationTargets.forEach(function(i){var o=i.element,r=h(o),a=this._rootContainsTarget(o),c=i.entry,l=t&&a&&this._computeTargetAndRootIntersection(o,e),u=i.entry=new n({time:s(),target:o,boundingClientRect:r,rootBounds:e,intersectionRect:l});c?t&&a?this._hasCrossedThreshold(c,u)&&this._queuedEntries.push(u):c&&c.isIntersecting&&this._queuedEntries.push(u):this._queuedEntries.push(u)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},o.prototype._computeTargetAndRootIntersection=function(i,n){if("none"!=t.getComputedStyle(i).display){var o=h(i),s=o,r=p(i),a=!1;while(!a){var c=null,u=1==r.nodeType?t.getComputedStyle(r):{};if("none"==u.display)return;if(r==this.root||r==e?(a=!0,c=n):r!=e.body&&r!=e.documentElement&&"visible"!=u.overflow&&(c=h(r)),c&&(s=l(c,s),!s))break;r=p(r)}return s}},o.prototype._getRootRect=function(){var t;if(this.root)t=h(this.root);else{var i=e.documentElement,n=e.body;t={top:0,left:0,right:i.clientWidth||n.clientWidth,width:i.clientWidth||n.clientWidth,bottom:i.clientHeight||n.clientHeight,height:i.clientHeight||n.clientHeight}}return this._expandRectByRootMargin(t)},o.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map(function(e,i){return"px"==e.unit?e.value:e.value*(i%2?t.width:t.height)/100}),i={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return i.width=i.right-i.left,i.height=i.bottom-i.top,i},o.prototype._hasCrossedThreshold=function(t,e){var i=t&&t.isIntersecting?t.intersectionRatio||0:-1,n=e.isIntersecting?e.intersectionRatio||0:-1;if(i!==n)for(var o=0;o<this.thresholds.length;o++){var s=this.thresholds[o];if(s==i||s==n||s<i!==s<n)return!0}},o.prototype._rootIsInDom=function(){return!this.root||d(e,this.root)},o.prototype._rootContainsTarget=function(t){return d(this.root||e,t)},o.prototype._registerInstance=function(){i.indexOf(this)<0&&i.push(this)},o.prototype._unregisterInstance=function(){var t=i.indexOf(this);-1!=t&&i.splice(t,1)},t.IntersectionObserver=o,t.IntersectionObserverEntry=n}function n(t){this.time=t.time,this.target=t.target,this.rootBounds=t.rootBounds,this.boundingClientRect=t.boundingClientRect,this.intersectionRect=t.intersectionRect||u(),this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,i=e.width*e.height,n=this.intersectionRect,o=n.width*n.height;this.intersectionRatio=i?Number((o/i).toFixed(4)):this.isIntersecting?1:0}function o(t,e){var i=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(i.root&&1!=i.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=r(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(i.rootMargin),this.thresholds=this._initThresholds(i.threshold),this.root=i.root||null,this.rootMargin=this._rootMarginValues.map(function(t){return t.value+t.unit}).join(" ")}function s(){return t.performance&&performance.now&&performance.now()}function r(t,e){var i=null;return function(){i||(i=setTimeout(function(){t(),i=null},e))}}function a(t,e,i,n){"function"==typeof t.addEventListener?t.addEventListener(e,i,n||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,i)}function c(t,e,i,n){"function"==typeof t.removeEventListener?t.removeEventListener(e,i,n||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,i)}function l(t,e){var i=Math.max(t.top,e.top),n=Math.min(t.bottom,e.bottom),o=Math.max(t.left,e.left),s=Math.min(t.right,e.right),r=s-o,a=n-i;return r>=0&&a>=0&&{top:i,bottom:n,left:o,right:s,width:r,height:a}}function h(t){var e;try{e=t.getBoundingClientRect()}catch(i){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):u()}function u(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function d(t,e){var i=e;while(i){if(i==t)return!0;i=p(i)}return!1}function p(t){var e=t.parentNode;return e&&11==e.nodeType&&e.host?e.host:e}})(window,document)},"623f":function(t,e,i){"use strict";i.r(e),i.d(e,"VLazyImagePlugin",function(){return o});var n={props:{src:{type:String,required:!0},srcPlaceholder:{type:String,default:""},srcset:{type:String},isBackground:{type:Boolean},isEditable:{type:Boolean},intersectionOptions:{type:Object,default:function(){return{}}},defaultText:{type:String}},data:function(){return{observer:null,intersected:!1,loaded:!1}},computed:{srcImage:function(){return this.intersected?this.src:this.srcPlaceholder},srcsetImage:function(){return!(!this.intersected||!this.srcset)&&this.srcset}},render:function(t){return this.isBackground?t("div",{style:{"background-image":"url(".concat(this.srcImage,")")},class:{"v-lazy-image":!0,"v-lazy-image-loaded":this.loaded}},[this.srcImage||!this.isEditable?"":this.defaultText]):t("img",{attrs:{src:this.srcImage,srcset:this.srcsetImage},class:{"v-lazy-image":!0,"v-lazy-image-loaded":this.loaded}})},mounted:function(){var t=this;this.$el.addEventListener("load",function(e){t.$el.getAttribute("src")!==t.srcPlaceholder&&(t.loaded=!0,t.$emit("load"))}),"undefined"!==typeof window&&(i("5abe"),this.observer=new IntersectionObserver(function(e){var i=e[0];i.isIntersecting&&(t.intersected=!0,t.observer.disconnect(),t.$emit("intersect"))},this.intersectionOptions),this.observer.observe(this.$el))},destroyed:function(){this.observer.disconnect()}};e["default"]=n;var o={install:function(t,e){t.component("VLazyImage",n)}}},addf:function(t,e,i){}}]);
//# sourceMappingURL=xthon.umd.min.48.js.map